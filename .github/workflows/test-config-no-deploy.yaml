name: Test chaos-test
on:
  push:
    branches:
      - test-config

jobs:
  config-test:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - uses: chi3316/rocketmq-test-tool@9801210d48cc203fa9860f0562d0b1d6946f22e0
        name: test config
        with:
          action: "test-config"
          ask-config: "${{ secrets.ACK_CONFIG_VIRGINA }}"
          job-id: ${{ strategy.job-index }}
          chaos-mesh-fault-file: ".github/chaos-configs/network-delay.yaml"
          openchaos-driver: ".github/chaos-configs/rocketmq-driver.yaml"
